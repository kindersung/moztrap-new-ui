!function(a,b){var c=a.createElement,d=b.Datepicker,e=function(a){a instanceof Date||(a=new Date);var b=this;b.init={},b.init.y=b.y=a.getFullYear(),b.init.m=b.m=a.getMonth()+1,b.init.d=b.d=a.getDate()},f=e.prototype;f.toDate=function(){var a=this;return new Date(a.y,a.m-1,a.d)},f.monthDays=[1,-2,1,0,1,0,1,1,0,1,0,1],f.nextMonth=function(){var a=this;return 12==a.m?(a.y+=1,a.m=1):a.m+=1,a.d=1,a},f.prevMonth=function(){var a=this;return 1==a.m?(a.y-=1,a.m=12):a.m-=1,a.d=1,a},f.getMonthDays=function(){var a=this,b=2==a.m&&(a.y%4==0&&a.y%100!=0||a.y%400==0)?1:0;return a.monthDays[a.m-1]+30+b},f.format=function(a){var b=this,c={"m+":b.m,"d+":b.d,"q+":Math.floor((b.m+2)/3)};/(y+)/.test(a)&&(a=a.replace(RegExp.$1,(b.y+"").substr(4-RegExp.$1.length)));for(var d in c)new RegExp("("+d+")").test(a)&&(a=a.replace(RegExp.$1,1==RegExp.$1.length?c[d]:("00"+c[d]).substr((""+c[d]).length)));return a};var g={zh:{dayTitle:["一","二","三","四","五","六","日"],monthTitle:["一","二","三","四","五","六","七","八","九","十","十一","十二"].map(function(a){return a+"月"}),dateTitle:function(a,b){return a+" 年 "+b+" 月"}}},h="c",k="i",l="am-datepicker-",m={BASIC:l+"day",ACTIVE:l+"day am-active",DISABLED:l+"day am-disabled",CURRENT:l+"day am-current"},n=yearClassSet={BASIC:"",ACTIVE:"am-active",CURRENT:"am-current",DISABLED:"am-disabled"},o=function(a){var b,c=(a.from,a.to,a.current),d=0,f=0,g=0,i=0,j={},l=c.toDate(),m=new e(l).prevMonth().getMonthDays(),n=(new e(l).nextMonth().getMonthDays(),c.getMonthDays());l.setDate(1);for(var o=(l.getDay()+6)%7;o>d;d++,i++)j[h+i]=-1,j[k+i]=m-o+1+d;for(;n>f;f++,i++)j[h+i]=0,j[k+i]=f+1;for(;42-n-o>g;g++,i++)j[h+i]=-1,j[k+i]=g+1;return c.y==c.init.y&&c.m==c.init.m&&(j[h+(o+c.init.d-1)]=2),b=o+c.d-1,j[h+b]=1,{active:b,obj:j}},p=function(a){for(var b,c=(a.from,a.to,a.current),d=0,e={};12>d;d++)e[h+d]=0,e[k+d]=d+1;return c.y==c.init.y&&(e[h+(c.init.m-1)]=2),b=c.m-1,e[h+b]=1,{active:b,obj:e}},q=function(a){for(var b,c=(a.from,a.to,a.current),d=0,e={},f=c.y,g=f%12,i=f-g;12>d;d++)e[h+d]=0,e[k+d]=i+d;return c.init.y-c.init.y%12==i&&(e[h+c.init.y%12]=2),b=g,e[h+b]=1,{active:b,obj:e}},r=function(a,b,c){var d=null,e=c;switch(a){case-1:d=b.DISABLED,e=null;break;case 0:d=b.BASIC;break;case 1:d=b.ACTIVE;break;case 2:d=b.CURRENT}return[d,e]},s={active:null,getInitialState:function(){var a=this,b=a.caculate(a.props);return a.active=b.active,b.obj},componentWillReceiveProps:function(a){var b=this,c=b.caculate(a);b.active=c.active,b.setState(c.obj)},onClick:function(a,b){b.stopPropagation();var c=this,d=c.active,e={};null!==d&&d!==a&&1===c.state[h+d]&&(e[h+d]=0),d!==a&&(e[h+a]=2==c.state[h+a]?2:1,c.active=a),c.props.select(c.state[k+a])}},t=a.createClass({displayName:"DatepickerDayTbody",mixins:[s],caculate:o,render:function(){var a=this,b=[];for(i=0;i<6;i++){var d=[];for(j=0;j<7;j++){var e=7*i+j,f=r(a.state[h+e],m,a.onClick.bind(a,e)),g=f[0],l=f[1];d.push(c("td",{key:e,className:g,onClick:l},a.state[k+e]))}b.push(c("tr",{key:i},d))}return c("tbody",null,b)}}),u=a.createClass({displayName:"DatepickerMonthTbody",mixins:[s],caculate:p,render:function(){for(var a,b,d,e=this,f=[],i=0,j=g[e.props.lang]||g.zh;12>i;i++)d=r(e.state[h+i],n,e.onClick.bind(e,i)),a=d[0],b=d[1],f.push(c("span",{key:"m-"+i,className:a,onClick:b},j.monthTitle[e.state[k+i]-1]));return c("tbody",null,c("tr",null,c("td",{colSpan:"7"},f)))}}),v=a.createClass({displayName:"DatepickerYearTbody",mixins:[s],caculate:q,render:function(){for(var a,b,d,e=this,f=[],g=0;12>g;g++)d=r(e.state[h+g],yearClassSet,e.onClick.bind(e,g)),a=d[0],b=d[1],f.push(c("span",{key:"y-"+g,className:a,onClick:b},e.state[k+g]));return c("tbody",null,c("tr",null,c("td",{colSpan:"7"},f)))}}),w=a.createClass({displayName:"DatepickerPanel",getDefaultProps:function(){return{from:null,to:null,current:new e,select:null}},getInitialState:function(){var a=this.props;return{panel:a.panel,current:a.current}},componentWillReceiveProps:function(a){this.setState({current:a.current})},changePanel:function(){var a=this;this.setState({panel:a.state.panel+1})},selectDay:function(a){var b=this,c=b.state.current;c.d=a,b.setState({current:c}),b.props.select(c)},selectPanel:function(a,b){var c=this,d=c.state.current;1==a?(d.m=b,b!=d.init.m&&(d.d=1)):(d.y=b,b!=d.init.y&&(d.d=1)),this.setState({current:d,panel:a})},onWheel:function(a){a.preventDefault(),this.goIcon(a.deltaY>0?1:-1)},goIcon:function(a,b){b&&b.stopPropagation();var c=this;stateArgs=c.state,propArgs=c.props,1==stateArgs.panel?a>0?stateArgs.current.nextMonth():stateArgs.current.prevMonth():2==stateArgs.panel?stateArgs.current.y+=a>0?1:-1:3==stateArgs.panel&&(stateArgs.current.y+=a>0?12:-12),c.setState({current:stateArgs.current})},render:function(){var a=this;if(stateArgs=a.state,propArgs=a.props,_lang=g[propArgs.lang]||g.zh,table=null,tableClass=l+"table",headClass=l+"header",switchClass=l+"switch",selectClass=l+"select",prevTh=c("th",{className:l+"prev"},c("i",{className:l+"prev-icon",onClick:a.goIcon.bind(a,1)})),nextTh=c("th",{className:l+"next"},c("i",{className:l+"next-icon",onClick:a.goIcon.bind(a,-1)})),1==stateArgs.panel)table=c("table",{className:tableClass},c("thead",null,c("tr",{className:headClass},prevTh,c("th",{colSpan:"5",className:switchClass},c("div",{className:selectClass,onClick:a.changePanel},_lang.dateTitle(stateArgs.current.y,stateArgs.current.m,stateArgs.d))),nextTh),c("tr",null,_lang.dayTitle.map(function(a,b){return c("th",{key:"th-"+b,className:l+"dow"},a)}))),c(t,{from:propArgs.from,to:propArgs.to,current:stateArgs.current,select:a.selectDay}));else if(2==stateArgs.panel)table=c("table",{className:tableClass},c("thead",null,c("tr",{className:headClass},prevTh,c("th",{colSpan:"5",className:switchClass},c("div",{className:selectClass,onClick:a.changePanel},stateArgs.current.y)),nextTh)),c(u,{from:propArgs.from,to:propArgs.to,current:stateArgs.current,lang:propArgs.lang,select:a.selectPanel.bind(a,1)}));else if(3==stateArgs.panel){var b=stateArgs.current.y-stateArgs.current.y%10;table=c("table",{className:tableClass},c("thead",null,c("tr",{className:headClass},prevTh,c("th",{colSpan:"5",className:switchClass},c("div",{className:selectClass},b,"-",b+11)),nextTh)),c(v,{from:propArgs.from,to:propArgs.to,current:stateArgs.current,select:a.selectPanel.bind(a,2)}))}return c("div",{className:"am-datepicker",style:{display:"block"},onWheel:a.onWheel},c("div",{className:l+"days",style:{display:"block"}},table))}}),x=a.createClass({displayName:"DatepickerInput",getDefaultProps:function(){return{from:null,to:null,current:new e,format:"yyyy-mm-dd",onSelect:null,lang:"zh",panel:1}},getInitialState:function(){var a=this.props;return{visible:!1,current:new e(a.current)}},componentWillReceiveProps:function(a){this.setState({visible:!1,current:a.current})},onClick:function(a){a.stopPropagation();var b=this;this.setState({visible:!b.state.visible})},onSelect:function(a){var b=this,c=b.props.onSelect;"function"==typeof c&&c(a.toDate()),b.setState({visible:!1,current:a})},render:function(){var a=this,b=a.state,d=a.props;return c("div",null,c("input",{type:"text",className:l+"input-field",value:b.current.format(d.format),onClick:a.onClick}),c("div",{style:{display:b.visible?null:"none"}},c(w,{from:d.from,to:d.to,panel:d.panel,current:b.current,lang:d.lang,select:a.onSelect})))}});b.Datepicker=x,x.noConflict=function(){return b.Datepicker=d,x},x.addLang=function(a,b){g[a]=b}}(React,window);